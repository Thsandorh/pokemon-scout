(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3330:function(e,t,a){Promise.resolve().then(a.bind(a,6117))},6117:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var s=a(7437),r=a(3145),l=a(2265),n=a(2293),i=a.n(n);let c="/pokemonscout".replace(/\/$/,""),o={state:"idle"};function d(){let[e,t]=(0,l.useState)(""),[a,r]=(0,l.useState)(!1),[n,o]=(0,l.useState)(""),[d,h]=(0,l.useState)([]),[p,_]=(0,l.useState)([]),[g,f]=(0,l.useState)(!1),[x,j]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=!1;return async function(){try{let a=await fetch("".concat(c,"/api/stores"),{cache:"no-store"});if(!a.ok)throw Error("H\xe1l\xf3zati hiba (".concat(a.status,")"));let s=await a.json();if(!e){var t;_(null!==(t=s.stores)&&void 0!==t?t:[])}}catch(e){console.error("Store fetch failed",e)}}(),()=>{e=!0}},[]),(0,l.useEffect)(()=>{let t=new AbortController;f(!0),j(null);let s=new URLSearchParams({limit:"100"});e.trim().length>0&&s.set("search",e.trim()),a&&s.set("inStock","true"),n&&s.set("storeId",n);let r=setTimeout(async()=>{var e,a;try{let a=await fetch("".concat(c,"/api/products?").concat(s.toString()),{cache:"no-store",signal:t.signal});if(!a.ok)throw Error("H\xe1l\xf3zati hiba (".concat(a.status,")"));let r=await a.json();h(null!==(e=r.products)&&void 0!==e?e:[])}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)return;j(null!==(a=e.message)&&void 0!==a?a:"Ismeretlen hiba")}finally{f(!1)}},250);return()=>{clearTimeout(r),t.abort()}},[e,a,n]);let k=(0,l.useMemo)(()=>{let e=new Map;return p.forEach(t=>e.set(t.id,t)),e},[p]);return(0,s.jsxs)("main",{className:i().main,children:[(0,s.jsxs)("header",{className:i().hero,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"Pok\xe9mon Scout"}),(0,s.jsx)("p",{children:"Figyelj\xfck a hazai Pok\xe9mon TCG k\xedn\xe1latot. Keress term\xe9kre, szűrj bolt szerint, \xe9s k\xe9rj \xe9rtes\xedt\xe9st \xe1r- vagy k\xe9szletv\xe1ltoz\xe1sr\xf3l."})]}),(0,s.jsxs)("div",{className:i().filters,children:[(0,s.jsxs)("label",{className:i().searchField,children:[(0,s.jsx)("span",{children:"Keres\xe9s"}),(0,s.jsx)("input",{value:e,placeholder:"Pl. Paldean Fates",onChange:e=>t(e.target.value),type:"search"})]}),(0,s.jsxs)("label",{className:i().selectField,children:[(0,s.jsx)("span",{children:"\xc1ruh\xe1z"}),(0,s.jsxs)("select",{value:n,onChange:e=>o(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"\xd6sszes bolt"}),p.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("label",{className:i().checkbox,children:[(0,s.jsx)("input",{type:"checkbox",checked:a,onChange:e=>r(e.target.checked)}),"Csak k\xe9szleten l\xe9vő term\xe9kek"]})]})]}),x?(0,s.jsxs)("p",{className:i().error,children:["Nem siker\xfclt bet\xf6lteni a term\xe9keket: ",x]}):null,(0,s.jsx)("section",{"aria-busy":g,className:i().grid,children:g&&0===d.length?(0,s.jsx)(u,{}):0===d.length?(0,s.jsx)("p",{className:i().empty,children:"Nem tal\xe1ltunk a szűrőnek megfelelő term\xe9ket."}):d.map(e=>{var t,a;return(0,s.jsx)(m,{product:e,storeName:null!==(a=null===(t=k.get(e.storeId))||void 0===t?void 0:t.name)&&void 0!==a?a:"Ismeretlen bolt"},e.id)})})]})}function u(){return(0,s.jsx)(s.Fragment,{children:Array.from({length:9}).map((e,t)=>(0,s.jsx)("div",{className:i().cardSkeleton},t))})}function m(e){var t,a;let{product:n,storeName:d}=e,[u,m]=(0,l.useState)(o),[h,p]=(0,l.useState)(""),[_,g]=(0,l.useState)(""),f=async e=>{if(e.preventDefault(),!h){m({state:"error",message:"Adj meg egy e-mail c\xedmet!"});return}m({state:"sending"});try{let e={productId:n.id,email:h},a=_.trim();if(a){let t=Number.parseInt(a,10);if(Number.isNaN(t))throw Error("Az \xe1rnak sz\xe1mnak kell lennie (pl. 14990).");e.targetPriceHuf=t}let s=await fetch("".concat(c,"/api/alerts"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){var t;let e=await s.json().catch(()=>null);throw Error(null!==(t=null==e?void 0:e.error)&&void 0!==t?t:"Ismeretlen hiba")}m({state:"success",message:"\xc1rfigyelő l\xe9trehozva! Ellenőrizd a postal\xe1d\xe1dat."}),p(""),g("")}catch(e){m({state:"error",message:e.message})}},x=n.currentPriceHuf?"".concat(n.currentPriceHuf.toLocaleString("hu-HU")," Ft"):"Ismeretlen \xe1r",j=null!==(t=n.status)&&void 0!==t?t:n.inStock?"K\xe9szleten":"Nincs k\xe9szleten";return(0,s.jsxs)("article",{className:i().card,children:[(0,s.jsx)("a",{href:n.productUrl,target:"_blank",rel:"noreferrer",className:i().imageWrapper,children:(0,s.jsx)(r.default,{src:null!==(a=n.imageUrl)&&void 0!==a?a:"https://dummyimage.com/400x400/eff1f5/6c757d&text=Pok%C3%A9mon",alt:n.name,fill:!0,sizes:"100%"})}),(0,s.jsxs)("div",{className:i().cardBody,children:[(0,s.jsx)("h2",{title:n.name,children:n.name}),(0,s.jsx)("p",{className:i().storeBadge,children:d}),(0,s.jsx)("p",{className:i().price,children:x}),(0,s.jsx)("p",{className:n.inStock?i().statusIn:i().statusOut,children:j}),(0,s.jsxs)("p",{className:i().meta,children:["Utols\xf3 friss\xedt\xe9s:"," ",new Date(n.lastSeenAt).toLocaleString("hu-HU")]})]}),(0,s.jsxs)("details",{className:i().alertBox,children:[(0,s.jsx)("summary",{children:"\xc1rfigyelő be\xe1ll\xedt\xe1sa"}),(0,s.jsxs)("form",{onSubmit:f,children:[(0,s.jsxs)("label",{children:["E-mail c\xedm",(0,s.jsx)("input",{type:"email",required:!0,value:h,placeholder:"te@pelda.hu",onChange:e=>p(e.target.value)})]}),(0,s.jsxs)("label",{children:["C\xe9l\xe1r (opcion\xe1lis)",(0,s.jsx)("input",{type:"number",min:0,value:_,placeholder:"Pl. 14990",onChange:e=>g(e.target.value)})]}),(0,s.jsx)("button",{type:"submit",disabled:"sending"===u.state,className:i().submit,children:"sending"===u.state?"Ment\xe9s...":"Ment\xe9s"})]}),"error"===u.state?(0,s.jsx)("p",{className:i().alertError,children:u.message}):null,"success"===u.state?(0,s.jsx)("p",{className:i().alertSuccess,children:u.message}):null]}),(0,s.jsxs)("a",{href:n.productUrl,target:"_blank",rel:"noreferrer",className:i().externalLink,children:["Megnyit\xe1s a(z) ",d," oldal\xe1n →"]})]})}},2293:function(e){e.exports={main:"page_main__GlU4n",hero:"page_hero__SKW6o",filters:"page_filters__syETL",searchField:"page_searchField__MHlbC",selectField:"page_selectField__HdiR5",checkbox:"page_checkbox__dY2AP",error:"page_error__Jil8M",grid:"page_grid__f5Kdy",card:"page_card__QV0Om",cardSkeleton:"page_cardSkeleton__QvOrA",shimmer:"page_shimmer__qPtWe",imageWrapper:"page_imageWrapper__OufeY",cardBody:"page_cardBody__v_3HE",price:"page_price___74c5",storeBadge:"page_storeBadge__e_2Tw",statusIn:"page_statusIn__LQ_uU",statusOut:"page_statusOut__21zIR",meta:"page_meta__N1c8V",alertBox:"page_alertBox__NRsed",submit:"page_submit__oMfyQ",alertError:"page_alertError__mlLTW",alertSuccess:"page_alertSuccess__LZMif",externalLink:"page_externalLink__yUIL5",empty:"page_empty__94dW_"}}},function(e){e.O(0,[591,145,971,117,744],function(){return e(e.s=3330)}),_N_E=e.O()}]);